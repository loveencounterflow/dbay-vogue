{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/vogue-scraper.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'DBAY-VOGUE/SCRAPER'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\nGUY                       = require 'guy'\nH                         = require './helpers'\n{ Vogue_common_mixin }    = require './vogue-common-mixin'\n{ HDML, }                 = require 'hdml'\n\n\n#===========================================================================================================\n### Collection of scrapers ###\nclass @Vogue_scrapers extends Vogue_common_mixin()\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    super()\n    @cfg        = { @defaults.vogue_scrapers_constructor_cfg..., cfg..., }\n    @types.validate.vogue_scrapers_constructor_cfg @cfg\n    @cfg        = GUY.lft.freeze @cfg\n    @d          = {}\n    @hub        = H.property_pending\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  _XXX_walk_scrapers: ->\n    yield { dsk, scraper, } for dsk, scraper of @d\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _scraper_from_dsk: ( dsk ) ->\n    unless ( R = @d[ dsk ] )?\n      throw new Error \"^Vogue_scrapers@1^ no such DSK: #{rpr dsk}\"\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  add: ( cfg ) ->\n    cfg         = { @defaults.vogue_scrapers_add_cfg..., cfg..., }\n    @types.validate.vogue_scrapers_add_cfg cfg\n    { dsk\n      scraper } = cfg\n    if @d[ dsk ]?\n      throw new Error \"^Vogue_scrapers@1^ DSK already in use: #{rpr dsk}\"\n    @d[ dsk ]   = scraper\n    scraper._set_hub @hub\n    return null\n\n\n#===========================================================================================================\n### Individual scraper ###\nclass @Vogue_scraper_ABC extends Vogue_common_mixin()\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    super()\n    @cfg        = { @defaults.vogue_scraper_constructor_cfg..., cfg..., }\n    @types.validate.vogue_scraper_constructor_cfg @cfg\n    @cfg        = GUY.lft.freeze @cfg\n    @hub        = H.property_pending\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  _html_from_html_or_buffer: ( html_or_buffer ) ->\n    @types.validate.vogue_html_or_buffer html_or_buffer\n    if ( @types.type_of html_or_buffer ) is 'buffer'\n      return html_or_buffer.toString @cfg.encoding\n    return html_or_buffer\n\n  #---------------------------------------------------------------------------------------------------------\n  html_from_details: ( row ) ->\n    { sid\n      dsk\n      ts\n      pid\n      rank\n      ### TAINT rename trend -> sparkline_data ###\n      sparkline_data\n      details }         = row\n    #.......................................................................................................\n    sid_html            = HDML.text \"#{sid}\"\n    dsk_html            = HDML.text dsk\n    pid_html            = HDML.text \"#{pid}\"\n    ts_html             = HDML.text ts\n    rank_html           = HDML.text \"#{rank}\"\n    title_html          = HDML.pair 'a', { href: details.title_url, }, HDML.text details.title\n    #.......................................................................................................\n    tds                 = [\n      HDML.pair 'td.sid', sid_html\n      HDML.pair 'td.dsk', dsk_html\n      HDML.pair 'td.pid', pid_html\n      HDML.pair 'td.ts', ts_html\n      HDML.pair 'td.rank', rank_html\n      HDML.pair 'td.sparkline', { 'data-dsk': dsk, 'data-pid': pid, 'data-sparkline_data': sparkline_data, }\n      # HDML.pair 'td.sparkline_data', sparkline_data_html\n      HDML.pair 'td.title', title_html\n      ]\n    #.......................................................................................................\n    return HDML.pair 'tr', null, tds.join '\\n'\n#\n  #---------------------------------------------------------------------------------------------------------\n  ### NOTE liable to change ###\n  _XXX_get_details_chart: ->\n    R                   = []\n    sparkline_data_json = @hub.vdb.get_latest_sparkline_data_json()\n    R.push HDML.pair 'div.trendchart', { 'data-trends': sparkline_data_json, }\n    return R.join '\\n'\n\n  #---------------------------------------------------------------------------------------------------------\n  ### TAINT use more generic way to display tabular data ###\n  ### NOTE liable to change ###\n  _XXX_get_details_table: ->\n    R = []\n    R.push HDML.pair 'h3', HDML.text \"DBay Vogue App / Trends\"\n    R.push HDML.open 'table#trends'\n    #.......................................................................................................\n    tds         = [\n      HDML.pair 'th', HDML.text \"SID\"\n      HDML.pair 'th', HDML.text \"DSK\"\n      HDML.pair 'th', HDML.text \"PID\"\n      HDML.pair 'th', HDML.text \"TS\"\n      HDML.pair 'th', HDML.text \"Rank\"\n      HDML.pair 'th', HDML.text \"Sparkline\"\n      # HDML.pair 'th', HDML.text \"Trend\"\n      HDML.pair 'th', HDML.text \"Title\"\n      ]\n    R.push HDML.pair 'tr', tds.join ''\n    #.......................................................................................................\n    # H = require '/home/flow/jzr/hengist/lib/helpers'\n    # H.tabulate 'scr_trends_ordered', @hub.vdb.db \"\"\"select\n    #   rnr,\n    #   dsk,\n    #   sid,\n    #   ts,\n    #   pid,\n    #   rank\n    #   from scr_latest_trends;\"\"\"\n    prefix = @hub.vdb.cfg.prefix\n    for row from @hub.vdb.db \"\"\"select * from #{prefix}_latest_trends_html;\"\"\"\n      R.push row.html\n    R.push HDML.close 'table'\n    return R.join '\\n'\n\n\n\n"
  ]
}